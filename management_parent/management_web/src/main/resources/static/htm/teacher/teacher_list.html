<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../../layui/css/layui.css"/>
    <script type="text/javascript" src="../../layui/lay/modules/layer.js"></script>
    <script type="text/javascript" src="../../layui/layui.js"></script>
    <script src="../../js/jquery-3.4.1.min.js"></script>
    <script>
        layui.use('table', function () {
            let table = layui.table;
            layer.msg('教师列表页面');
        });

        function openView() {
            layer.open({
                type: 2,
                title: '教师详情',
                shadeClose: true,
                shade: 0.8,
                area: ['50%', '90%'],
                content: './student_view.html' //iframe的url
            });
        }

        function openAdd() {
            layer.open({
                type: 2,
                title: '添加教师',
                shadeClose: true,
                shade: 0.8,
                area: ['50%', '90%'],
                content: './teacher_add.html' //iframe的url
            });
        }
        function userdelete(id){
            $.ajax({
                url:"/contacts/deleteContacts",
                type:"put",
                data:{"id":id},
                success:function () {
                    location.reload("/htm/teacher/teacher_list.html")
                }
            })

        }

        $(function () {
            $.ajax({
                url: "/contacts/showContacts",
                type: "get",
                data: {"state": "1"},
                statusCode: {
                    200: function (data) {
                        $.each(data, function (index, ele) {
                            $("#tb01").append(`<tr>
            <td>${index+1}</td>
            <td>${ele.id}</td>
            <td>${ele.name}</td>
            <td>${ele.telephone}</td>
            <td>${ele.byProId.name}${ele.byCitId.name}</td>
            <td>${ele.position.pName}</td>
            <td>
                <button class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail" onclick="openView()">查看</button>
                <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del"  onclick="userdelete(${ele.id})">删除</a>
            </td>
        </tr>`)
                        })
                    }
                }
            })
        })
    </script>
</head>
<body>
<div>
    <div class="layui-btn-group">
        <button type="button" class="layui-btn layui-btn-primary layui-btn-sm" onclick="openAdd()">
            <i class="layui-icon">&#xe654;&nbsp;添加</i>
        </button>
        <button type="button" class="layui-btn layui-btn-primary layui-btn-sm">
            <i class="layui-icon">&#xe640;&nbsp;删除</i>
        </button>
    </div>
    <table class="layui-table" lay-data="{height: 'full-50', cellMinWidth: 80, page: true, limit:30}">
        <thead>
        <tr>
            <th lay-data="{type:'checkbox'}"></th>
            <th lay-data="{field:'id', width:100, sort: true, align: 'center'}">ID</th>
            <th lay-data="{field:'username', width:100, align: 'center'}">姓名</th>
            <th lay-data="{field:'sex', width:150, sort: true, align: 'center'}">手机号</th>
            <th lay-data="{field:'sign', minWidth: 150, align: 'center'}">住址</th>
            <th lay-data="{field:'experience', sort: true, align: 'center'}">职务</th>
            <th lay-data="{field:'score', sort: true, minWidth: 100, align: 'center'}">操作</th>
        </tr>
        </thead>
        <tbody id="tb01">

        </tbody>
    </table>
</div>
</body>
</html>